# 界回（KAIKAI）

> あなたのシフトに、旅のリズムを。  
> 働く"回"の中に、"界"の癒しを。

---

## 🧭 概要

看護師の勤務サイクルと星野リゾート「界タビ20s」プランを掛け合わせ、**「今のシフト周期で予約できる日」を自動で算出する**アプリケーションです。

### コンセプト

- **シフトサイクル × 旅プランの予約可能日抽出**
- 看護師の4週間シフトサイクルに最適化
- 界タビ20s（20代限定・平日・44日前予約開始）のルールに準拠

---

## 🏗️ 技術スタック

| レイヤー | 技術 |
|---------|------|
| **Backend** | Ruby 3.3.6 + Rails 8.0.3 (API mode, DBなし) |
| **Frontend** | React 19 + TypeScript 5.9 + Vite 7.1 + TailwindCSS 4.1 |
| **Infrastructure** | Docker + Docker Compose |

### 特徴

- ✨ データベース不要の軽量構成
- 🎯 日付計算のみに特化したMVP
- 🐳 Docker環境で簡単セットアップ

---

## ✨ 実装範囲（MVP段階）

| 区分 | 機能名 | 内容 |
|------|--------|------|
| 🗓️ | 入力フォーム | Aシフト／Bシフト発表日を入力 |
| 🧮 | API | `/api/v1/reservable_dates` で日付演算を実行 |
| 📋 | 結果表示 | Railsで算出した「予約可能日」をリスト表示 |
| ⚠️ | バリデーション | 不正入力・逆転日付のチェック |
| ⏳ | ローディング | 計算中のスピナー or テキスト表示 |
| 💬 | 補足文 | 界タビ20sルール（20代・平日・44日前）を明記 |

---

## ⚙️ API仕様

### エンドポイント

```
POST /api/v1/reservable_dates
Content-Type: application/json
```

### リクエスト例

```json
{
  "a_shift_date": "2025-10-17",
  "b_shift_date": "2025-11-14"
}
```

### レスポンス例（成功）

```json
{
  "reservable_dates": [
    "2025-11-06",
    "2025-11-07",
    "2025-11-10",
    "2025-11-11"
  ]
}
```

### レスポンス例（エラー）

```json
{
  "error": "Invalid date range or missing parameters"
}
```

### 判定ルール

1. **シフト期間内**: Aシフト ≦ 対象日 ＜ Bシフト
2. **平日のみ**: 月曜日〜木曜日
3. **予約可能日**: 現在から44日以降
4. **検索上限**: 60日以内

---

## 🎨 UI概要（MVP）

```
───────────────────────────────
界回（KAIKAI）
───────────────────────────────
あなたのシフトに、旅のリズムを。

Aシフト発表日： [2025-10-17]
Bシフト発表日： [2025-11-14]

[ 🔍 予約可能日を表示 ]

───────────────────────────────
✅ 2025-11-06（木）
✅ 2025-11-10（月）
✅ 2025-11-11（火）

ℹ️ 「界タビ20s」：20代限定・平日・44日前予約開始
───────────────────────────────
界回 © 2025
───────────────────────────────
```

---

## 🎨 デザイン指針

### カラーパレット

| 色名 | カラーコード | 用途 |
|------|-------------|------|
| **界藍** | `#4B5563` | メインカラー |
| **淡藤** | `#A5B4FC` | アクセント |
| **白磁** | `#F9FAFB` | ベース |

### フォント

- **和文**: Noto Sans JP
- **英文**: Raleway

### UIテーマ

- 和の静けさ × 医療の清潔感
- 余白を生かした静かなミニマルデザイン

---

## 🧩 状態フロー（React）

```
[初期] → [入力] → [ロード中] → [結果表示]
                          ↓
                       [エラー表示]
```

---

## 🚀 セットアップ

### 前提条件

- Docker
- Docker Compose

### 起動手順

```bash
# リポジトリをクローン
git clone <repository-url>
cd kaikai_app

# Dockerイメージをビルド
docker compose build

# コンテナを起動
docker compose up -d

# ログを確認
docker compose logs -f
```

### アクセス先

- **Frontend**: http://localhost:5173
- **Backend API**: http://localhost:3000

### よく使うコマンド

```bash
# コンテナを停止
docker compose down

# コンテナを再起動
docker compose restart

# コンテナの状態確認
docker compose ps
```

---

## 📁 ディレクトリ構成

```
kaikai_app/
├── backend/              # Rails API
│   ├── app/
│   │   └── controllers/
│   ├── config/
│   ├── Gemfile
│   └── Dockerfile.dev
│
├── frontend/             # React + TypeScript
│   ├── src/
│   │   ├── App.tsx
│   │   ├── main.tsx
│   │   └── index.css
│   ├── package.json
│   ├── vite.config.ts
│   ├── tsconfig.json
│   └── Dockerfile.dev
│
├── docker-compose.yml
├── README.md
├── 環境構築メモ.md
└── 環境構築メモ_最小構成版.md
```

---

## 🧱 今後の拡張予定（v2以降）

| 機能 | 概要 |
|------|------|
| 界プランAPI連携 | 対象施設・料金・空室情報を表示 |
| シフト自動取得 | Googleカレンダー連携 |
| 祝日除外機能 | 日本の祝日カレンダー適用 |
| 予約通知 | 44日前0時の予約可能通知 |
| カスタム周期設定 | 4週 → 任意周期化 |

---

## 📝 開発環境詳細

詳細な環境構築手順は以下を参照してください：

- **標準版**: [環境構築メモ.md](./環境構築メモ.md)
- **最小構成版**: [環境構築メモ_最小構成版.md](./環境構築メモ_最小構成版.md)

---

## 📄 ライセンス

界回（KAIKAI） © 2025

---

## 🙏 謝辞

星野リゾート「界タビ20s」プランにインスピレーションを受けて開発しました。
